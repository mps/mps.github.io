---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { siteConfig } from '../data/site';

// Get recent posts for selected writing
const allPosts = await getCollection('posts', ({ data }) => data.published !== false);
const sortedPosts = allPosts.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

// Featured posts (hand-picked slugs)
const featuredSlugs = [
  'building-a-great-engineering-team-part-one',
  'on-building-great-products',
  'deep-not-wide',
  'strong-opinions-weakly-held',
  'awareness',
];

const featuredPosts = featuredSlugs
  .map(slug => sortedPosts.find(post => post.slug === slug))
  .filter(Boolean);

// Recent posts (latest 5, excluding featured)
const recentPosts = sortedPosts
  .filter(post => !featuredSlugs.includes(post.slug))
  .slice(0, 5);
---

<BaseLayout>
  <div class="max-w-2xl mx-auto px-6 pb-12">
    <section class="mb-16">
      <p class="text-lg md:text-xl leading-relaxed text-neutral-700 dark:text-neutral-300">
        I build software and lead engineering teams at <a href="https://chick-fil-a.com">Chick-fil-A</a>,
        focused on International. Previously at <a href="https://bignerdranch.com">Big Nerd Ranch</a>
        and Vertigo (now Disney Streaming).
      </p>
    </section>

    <section class="mb-16">
      <h2 class="text-sm uppercase tracking-wide text-neutral-500 dark:text-neutral-400 mb-6">
        Selected Writing
      </h2>
      <ul class="space-y-3">
        {featuredPosts.map((post) => (
          <li class="flex items-baseline gap-2">
            {post.data.link ? (
              <>
                <a
                  href={post.data.link}
                  class="text-neutral-900 dark:text-neutral-100 no-underline hover:underline"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  {post.data.title}
                </a>
                <a
                  href={`/${post.slug}`}
                  class="text-neutral-400 dark:text-neutral-500 no-underline hover:text-neutral-600 dark:hover:text-neutral-300"
                  title="Permalink"
                >
                  ↗
                </a>
              </>
            ) : (
              <a
                href={`/${post.slug}`}
                class="text-neutral-900 dark:text-neutral-100 no-underline hover:underline"
              >
                {post.data.title}
              </a>
            )}
          </li>
        ))}
      </ul>
    </section>

    <section class="mb-16">
      <h2 class="text-sm uppercase tracking-wide text-neutral-500 dark:text-neutral-400 mb-6">
        Recent
      </h2>
      <ul class="space-y-3">
        {recentPosts.map((post) => (
          <li class="flex justify-between items-baseline gap-4">
            <span class="flex items-baseline gap-2">
              {post.data.link ? (
                <>
                  <a
                    href={post.data.link}
                    class="text-neutral-900 dark:text-neutral-100 no-underline hover:underline"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    {post.data.title}
                  </a>
                  <a
                    href={`/${post.slug}`}
                    class="text-neutral-400 dark:text-neutral-500 no-underline hover:text-neutral-600 dark:hover:text-neutral-300"
                    title="Permalink"
                  >
                    ↗
                  </a>
                </>
              ) : (
                <a
                  href={`/${post.slug}`}
                  class="text-neutral-900 dark:text-neutral-100 no-underline hover:underline"
                >
                  {post.data.title}
                </a>
              )}
            </span>
            <span class="text-sm text-neutral-400 dark:text-neutral-500 shrink-0">
              {new Date(post.data.date).getFullYear()}
            </span>
          </li>
        ))}
      </ul>
      <p class="mt-6">
        <a href="/blog" class="text-neutral-500 dark:text-neutral-400 text-sm">
          view all posts →
        </a>
      </p>
    </section>

    <section>
      <h2 class="text-sm uppercase tracking-wide text-neutral-500 dark:text-neutral-400 mb-6">
        Work
      </h2>
      <ul class="space-y-3">
        <li>
          <span class="text-neutral-900 dark:text-neutral-100">Chick-fil-A</span>
          <span class="text-neutral-400 dark:text-neutral-500"> — </span>
          <a href="https://www.chick-fil-a.ca" class="text-neutral-400 dark:text-neutral-500 hover:text-neutral-600 dark:hover:text-neutral-300" target="_blank" rel="noopener noreferrer">Canada</a>
          <span class="text-neutral-400 dark:text-neutral-500"> | </span>
          <a href="https://www.chick-fil-a.pr" class="text-neutral-400 dark:text-neutral-500 hover:text-neutral-600 dark:hover:text-neutral-300" target="_blank" rel="noopener noreferrer">Puerto Rico</a>
          <span class="text-neutral-400 dark:text-neutral-500"> | </span>
          <a href="https://www.chick-fil-a.com.sg" class="text-neutral-400 dark:text-neutral-500 hover:text-neutral-600 dark:hover:text-neutral-300" target="_blank" rel="noopener noreferrer">Singapore</a>
          <span class="text-neutral-400 dark:text-neutral-500"> | </span>
          <a href="https://www.chick-fil-a.co.uk" class="text-neutral-400 dark:text-neutral-500 hover:text-neutral-600 dark:hover:text-neutral-300" target="_blank" rel="noopener noreferrer">UK</a>
          <span class="text-neutral-400 dark:text-neutral-500"> | </span>
          <a href="https://order.chick-fil-a.com" class="text-neutral-400 dark:text-neutral-500 hover:text-neutral-600 dark:hover:text-neutral-300" target="_blank" rel="noopener noreferrer">Web Ordering</a>
          <span class="text-neutral-400 dark:text-neutral-500"> | </span>
          <a href="https://www.chick-fil-a.com/delivery" class="text-neutral-400 dark:text-neutral-500 hover:text-neutral-600 dark:hover:text-neutral-300" target="_blank" rel="noopener noreferrer">Delivery</a>
          <span class="text-neutral-400 dark:text-neutral-500"> | One & Canada Apps</span>
        </li>
        <li>
          <a
            href="https://www.everybodyeverywhere.com"
            class="text-neutral-900 dark:text-neutral-100 no-underline hover:underline"
            target="_blank"
            rel="noopener noreferrer"
          >
            Everybody Everywhere
          </a>
          <span class="text-neutral-400 dark:text-neutral-500"> — global movement platform</span>
        </li>
        <li>
          <a
            href="http://gitty.mstrick.com"
            class="text-neutral-900 dark:text-neutral-100 no-underline hover:underline"
            target="_blank"
            rel="noopener noreferrer"
          >
            Gitty
          </a>
          <span class="text-neutral-400 dark:text-neutral-500"> — GitHub client for iOS</span>
        </li>
        <li>
          <a
            href="https://easydigitaldownloads.com"
            class="text-neutral-900 dark:text-neutral-100 no-underline hover:underline"
            target="_blank"
            rel="noopener noreferrer"
          >
            Easy Digital Downloads
          </a>
          <span class="text-neutral-400 dark:text-neutral-500"> — WordPress e-commerce</span>
        </li>
        <li>
          <a
            href="https://apps.apple.com/app/golfnow-book-tee-times-golf-gps/id359295017"
            class="text-neutral-900 dark:text-neutral-100 no-underline hover:underline"
            target="_blank"
            rel="noopener noreferrer"
          >
            GolfNow
          </a>
          <span class="text-neutral-400 dark:text-neutral-500"> — tee time booking platform</span>
        </li>
        <li>
          <span class="text-neutral-900 dark:text-neutral-100">Radio Disney</span>
          <span class="text-neutral-400 dark:text-neutral-500"> — streaming app for Disney</span>
        </li>
        <li>
          <span class="text-neutral-900 dark:text-neutral-100">Golf Channel</span>
          <span class="text-neutral-400 dark:text-neutral-500"> — mobile apps and instruction platform</span>
        </li>
      </ul>
      <p class="mt-6">
        <a
          href="https://linkedin.com/in/mps/"
          class="text-neutral-500 dark:text-neutral-400 text-sm"
          target="_blank"
          rel="noopener noreferrer"
        >
          view full work history →
        </a>
      </p>
    </section>
  </div>
</BaseLayout>
